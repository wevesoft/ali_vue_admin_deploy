import{J as P,k as S,r as y,o as C,L as T,K as D,M as q,C as e,y as p,B as o,_ as G,N as V,z as l,S as z,x as A,T as $,U as E,D as b,A as i,P as K,Q as M}from"./gW4XaDQe.js";import{g as O,a as J}from"./CBC8_xwp.js";import{u as Q}from"./CSTdja__.js";import{_ as j}from"./DlAUqK2U.js";import{_ as F,a as H}from"./DGav2OGV.js";import{_ as W}from"./Bi-CW2-s.js";import{_ as X,a as Y}from"./DSPiY0No.js";import{_ as Z}from"./BWEAjELS.js";const oo={key:0,class:"q-mb-md"},eo=["src"],to={class:"text-body2 q-mb-md"},no={class:"q-mt-sm"},so={__name:"google",setup(ao){const d=D(),g=P(),k=Q(),c=S(()=>k.apiBase.value||"http://localhost:8080"),a=y(null),x=y("");C(async()=>{var f,n,r;console.log("🔐 Google page mounted"),console.log("🌍 현재 API Base:",c),console.log("🔧 API Base 타입:",typeof c),console.log("🔧 API Base 값:",c.value||c);try{const _=O(),s=await J(_);if(s){console.log("✅ Google login result:",s),a.value={displayName:s.user.displayName,email:s.user.email,photoURL:s.user.photoURL,uid:s.user.uid},x.value=new Date().toLocaleString("ko-KR");const u=await s.user.getIdToken();try{const t=`${c.value}/auth/google`;console.log("🌐 백엔드 API 호출 시작:",t),console.log("🔧 사용할 토큰:",u.substring(0,20)+"...");const m=await T.post(t,null,{headers:{Authorization:`Bearer ${u}`},withCredentials:!0,timeout:1e4});console.log("✅ 백엔드 응답:",m.data),m.data.result===!0?(g.setLoggedIn(),console.log("✅ 로그인 성공")):(console.error("❌ 백엔드 인증 실패"),g.setLoggedOut())}catch(t){console.error("❌ 백엔드 요청 실패:",t),console.error("❌ 에러 상세:",((f=t.response)==null?void 0:f.data)||t.message),console.error("❌ 에러 코드:",(n=t.response)==null?void 0:n.status),console.error("❌ 에러 URL:",(r=t.config)==null?void 0:r.url),g.setLoggedOut()}}else console.log("❌ Google login result not found"),d.push("/login")}catch(_){console.error("❌ Google login error:",_),d.push("/login")}});const B=()=>{d.push("/dashboard")};return(f,n)=>{const r=z,_=V,s=E,u=Y,t=Z,m=X,N=M,L=K,w=G,I=W,R=H,U=F;return p(),q(U,null,{default:e(()=>[o(R,null,{default:e(()=>[o(I,{class:"flex flex-center"},{default:e(()=>[o(w,{style:{width:"400px"}},{default:e(()=>[o(_,{class:"text-center"},{default:e(()=>[o(r,{name:"check_circle",color:"green",size:"64px"}),n[0]||(n[0]=l("div",{class:"text-h5 q-mt-md"},"구글 로그인 성공!",-1)),n[1]||(n[1]=l("div",{class:"text-body2 text-grey q-mt-sm"}," 구글 계정으로 로그인되었습니다. ",-1))]),_:1,__:[0,1]}),o(_,null,{default:e(()=>{var h,v;return[a.value?(p(),A("div",oo,[o(m,null,{default:e(()=>[o(u,{avatar:""},{default:e(()=>[o(s,null,{default:e(()=>[a.value.photoURL?(p(),A("img",{key:0,src:a.value.photoURL},null,8,eo)):(p(),q(r,{key:1,name:"person"}))]),_:1})]),_:1}),o(u,null,{default:e(()=>[o(t,{class:"text-weight-bold"},{default:e(()=>[b(i(a.value.displayName),1)]),_:1}),o(t,{caption:""},{default:e(()=>[b(i(a.value.email),1)]),_:1})]),_:1})]),_:1})])):$("",!0),l("div",to,[n[2]||(n[2]=l("strong",null,"로그인 정보:",-1)),l("ul",no,[l("li",null,"이메일: "+i(((h=a.value)==null?void 0:h.email)||"N/A"),1),l("li",null,"이름: "+i(((v=a.value)==null?void 0:v.displayName)||"N/A"),1),l("li",null,"로그인 시간: "+i(x.value),1)])])]}),_:1}),o(L,{align:"center"},{default:e(()=>[o(N,{color:"primary",label:"대시보드로 이동",onClick:B,class:"full-width"})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}},go=j(so,[["__scopeId","data-v-307cb35c"]]);export{go as default};
